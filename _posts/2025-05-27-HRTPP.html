---
title: "HRTPP: Hybrid-Rule Temporal Point Processes"
date: 2025-05-27
permalink: /posts/hrtpp
excerpt: "ECML-PKDD 2025"
tags: [html, posts, conference]
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HRTPP: Hybrid-Rule Temporal Point Processes</title>
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f6f9;
      color: #2d2d2d;
      line-height: 1.7;
    }

    header {
      background: linear-gradient(90deg, #4e54c8, #8f94fb);
      color: white;
      padding: 60px 20px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    header h1 {
      font-family: 'DM Serif Display', serif;
      font-size: 2.8em;
      margin-bottom: 10px;
    }

    header p {
      font-size: 1.2em;
      opacity: 0.9;
    }

    main {
      max-width: 1000px;
      margin: -40px auto 60px;
      padding: 20px;
    }

    section {
      background: white;
      border-radius: 12px;
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.05);
    }

    h2 {
      color: #4e54c8;
      margin-top: 0;
      font-weight: 600;
    }

    h3 {
      margin-top: 1.5em;
      color: #333;
      font-weight: 600;
    }

    p, li {
      font-size: 1.05em;
    }

    ul {
      padding-left: 20px;
    }

    .equation {
      text-align: center;
      margin: 20px 0;
      background: #f0f2f7;
      padding: 10px 20px;
      border-left: 4px solid #8f94fb;
      border-radius: 6px;
      font-family: 'Courier New', monospace;
    }

    code {
      background: #e8ebf5;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.95em;
    }

    @media (max-width: 768px) {
      header h1 {
        font-size: 2em;
      }
      section {
        padding: 20px;
      }
    }

    .link-buttons {
        margin-top: 20px;
        }

        .link-buttons .btn {
        display: inline-block;
        background-color: white;
        color: #4e54c8;
        border: 2px solid white;
        padding: 10px 20px;
        margin: 5px 10px;
        border-radius: 30px;
        text-decoration: none;
        font-weight: 600;
        transition: all 0.3s ease;
        }

        .link-buttons .btn:hover {
        background-color: rgba(255, 255, 255, 0.1);
        border-color: #fff;
        color: #fff;
        }
  </style>
  <!-- MathJax -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>
<body>

  <header>
    <h1>Hybrid-Rule Temporal Point Processes (HRTPP)</h1>
    <p>A Novel Framework for Interpretable and Accurate Event Sequence Modeling in Healthcare</p>
    <div class="link-buttons">
    <a href="https://github.com/yy-c/HRTPP" target="_blank" class="btn">Code</a>
    <a href="https://arxiv.org/abs/2504.11344" target="_blank" class="btn">Paper</a>
</div>
  </header>

  <main>

    <section>
      <h2>Introduction</h2>
      <p>
        HRTPP is a novel framework designed to improve both the <strong>interpretability</strong> and <strong>predictive accuracy</strong> of Temporal Point Process (TPP) models, especially in clinical settings. Unlike traditional TPPs, HRTPP integrates logic-based rules and numerical attributes, leading to more precise and explainable predictions.
      </p>
    </section>

    <section>
      <h2>Core Methodology</h2>

      <h3>1. Basic Intensity (\( \lambda_{base} \))</h3>
      <p>Represents the fundamental tendency of event occurrence as a trainable parameter:</p>
      <div class="equation">$$ \lambda_{base} = \lambda_0 $$</div>

      <h3>2. Rule-Based Intensity (\( \lambda_{rule}(t) \))</h3>
      <p>Encodes temporal logic rules optimized through Bayesian search:</p>
      <div class="equation">$$ \lambda_{rule}(t) = \sum_{R_j \in R} \alpha_j e_j(t) $$</div>
      <div class="equation">$$ e_j(t) = \sum_{t_j \in T_j} d_{rule}(t - t_j) $$</div>

      <h3>3. Numerical Feature Intensity (\( \lambda_{num}(t) \))</h3>
      <p>Dynamically modulates intensity using clinical measurements:</p>
      <div class="equation">$$ \lambda_{num}(t) = \sum_{k=1}^{K} \beta_k g_k(t) $$</div>
      <div class="equation">$$ g_k(t) = m_k \sum_{i:k_i=k} v_i d_{num}(t - t_i) $$</div>
      <p>Where \( m_k = 1 \) if \( X_k \in X_V \), and \( m_k = 0 \) otherwise.</p>

      <h3>Combined Intensity Function</h3>
      <div class="equation">
        $$ \lambda(t|H_t) = \text{Softplus}\left( \lambda_{base}(t) + \lambda_{rule}(t) + \lambda_{num}(t) \right) $$
      </div>
      <div class="equation">
        $$ \lambda(t|H_t) = \text{Softplus}\left( \lambda_0 + \sum_{R_j \in R} \alpha_j \sum_{t_j \in T_j} d_{rule}(t - t_j) + \sum_{k=1}^{K} \beta_k m_k \sum_{i:k_i = k} v_i d_{num}(t - t_i) \right) $$
      </div>
    </section>

    <section>
      <h2>Rule Mining Strategy</h2>

      <h3>Rule Candidate Generation</h3>
      <p>
        Generates candidate rules from historical data by filtering predicates and controlling rule complexity. This reduces the combinatorial search space.
      </p>

      <h3>Bayesian Optimization</h3>
      <p>
        Refines the rule set by maximizing log-likelihood using a probabilistic acquisition function. This balances interpretability with predictive utility.
      </p>
    </section>

    <section>
      <h2>Training and Loss</h2>
      <p>
        HRTPP parameters are trained by minimizing the negative log-likelihood:
      </p>
      <div class="equation">
        $$ NLL(\Theta) = -\sum_{i=1}^{N} \log \lambda(t_i|H_{t_i}) + \int_{0}^{t_N} \lambda(t|H_t) dt $$
      </div>
    </section>

    <section>
      <h2>Evaluation and Results</h2>
      <p>Evaluation is based on:</p>
      <ul>
        <li>Rule validity</li>
        <li>Model fitting quality (NLL)</li>
        <li>Temporal prediction accuracy (RMSE, Rule Accuracy)</li>
      </ul>
      <p>
        Tests on real-world datasets (AKI, Stroke, Sepsis, CAD) demonstrate that HRTPP outperforms existing interpretable models. Case studies validate the rulesâ€™ clinical relevance. Ablation confirms that numerical features and rule mining phases contribute significantly to performance and robustness.
      </p>
    </section>

  </main>

</body>
</html>
